
<% @thistemplate = ::Template.find(params[:id])
   @site = Site.find(params[:site])



    %>
  <div class="row">
		<div class="col-sm-3">


      <%= render "siteContentModel" %>

      <!-- <p>User Workflow > Template
      <p>Breadcrumbs > Information Architecture path
        <hr> -->
      <h4>Page Purpose</h4>
      <p><%= @thistemplate.page_purpose %></p>
      <hr>
      <h4>Messaging</h4>
      <% @templatemessage = HierarchyMapping.where template_id: (params[:id]) %>
      <% @templatemessage.each do |h| %>
          <h5><%= h.hierarchy.name.html_safe %></h5>
          <p><%= h.hierarchy.description.html_safe %>
              <p><%= link_to "Audience Message Guide", "#myModal", :class => "btn btn-info align-center", "data-toggle" => "modal" %>
                <!-- , "#my-modal", :class => "btn", "data-toggle" => "modal"  -->
                      <!-- Modal -->
                      <div id="myModal" class="modal fade" role="dialog">
                        <div class="modal-dialog">

                          <!-- Modal content-->
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                              <h3 class="modal-title"><small><%= @site.name %></small><br><%= h.hierarchy.name.html_safe %></h3>
                            </div>
                            <div class="modal-body">

                              <table class="table table-hover">
                                <thead>
                                  <tr>
                                    <th scope="col">Audience</th>
                                    <th scope="col">Message</th>
                                  </tr>
                                </thead>
                                <tbody>


                                <% @audiencemessage = AudienceMessage.joins(:audience, :site).where(hierarchy_id: h.hierarchy.id, site_id: @site.id) %>
                                <% @audiencemessage.each do |m| %>
                                  <tr>
                                    <td scope="row" width="30%"><h4><%= m.audience.name %></h4></td>
                                    <td><p><%= m.message %></p></td>
                                  </tr>
                                <% end %>

                              </tbody>
                            </table>


                              <!-- <p><img style="width:100%;" src="http://contentmodel-jci-assets.s3.amazonaws.com/images/WebFootprint_HighLevel_v4.png"></p> -->
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                          </div>

                        </div>
                      </div>




      <% end %>
        <hr>
      <h4>KPI</h4>
        <%= @thistemplate.kpi %>
      <hr>
      <h4>Likely Task</h4>
      <%= @thistemplate.likely_task %>
        <hr>
      <h4>Personalization Needs</h4>
      <%= @thistemplate.personalization_needs %>
        <hr>
      <h4>Creation Guidelines</h4>
      <%= @thistemplate.creation_guidelines %>

		</div>
		<div class="col-sm-9">
      <h1><%= @thistemplate.name %>

        <% if @thistemplate.existing == true %>
        <span class="badge badge-light">Existing</span>
        <% else %>
        <% end %>
        <small class="text-muted">Page Template
          <% if @thistemplate.image.blank? == false %>
           / <a href="<%= @thistemplate.image %>" target="_blank">view layout</a>
          <% else %>
          <% end %>
        </small>
      </h1>

      <%= link_to "Download Page Requirements Document (PRD)", @thistemplate.document, :class => "btn btn-info", target: "_blank" %>
          <!-- <ol class="breadcrumb">
          <% @thistemplate.components.each do |b| %>
              <li class="breadcrumb-item"><a href="#<%= b.name %>"><%= b.name %></a></li>
          <% end %>
          </ol> -->

        <% @thistemplate.components.each do |c| %>
            <a id="<%= c.name %>"></a>
            <h3><%= c.name %> <% if c.componenttype_id == 1 %>
                      <span class="badge badge-light">Existing</span>
                    <% else %>
                    <% end %>
                    <% if c.componenttype_id == 2 %>
                      <span class="badge badge-light">Existing->Update</span>
                    <% else %>
                    <% end %><small class="text-muted">Component</small></h3>

            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Attribute</th>
                  <th scope="col">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td scope="row">Goal</td>
                  <td><i><%= c.goal %></i></td>
                </tr>
                <tr>
                  <td scope="row">Description</td>
                  <td><i><%= c.description %></i></td>
                </tr>
                <tr>
                  <td scope="row">CTA</td>
                  <td><i><%= c.cta %></i></td>
                </tr>
                <tr>
                  <td scope="row">Content Assets</td>
                  <td><i><%= c.content_assets %></i></td>
                </tr>
              </tbody>
            </table>



                <!-- <% c.text_items.each do |t| %>
                      <h5 class="text-info"><%= t.name %> <small class='text-muted'>Item</small></h5>
                         <p><%= t.itemtext %> </p>
                <% end %> -->
        <% end %>



		</div>
	</div>
  	<hr>
  <div class="row">
    <div class="col-sm">

        <%= render "footer" %>

    </div>
  </div>
